<body>
    <div th:fragment="frame_left_menu" id="sidebar" class="main-sidebar main-sidebar--expand">
        <div style="padding-top: 10px;"></div>
        <div class="logo" onclick="location.href='/main';" style="cursor: pointer;">
            <span class="hidden"></span>
        </div>
        <div class="profile">
            <div class="profile__img profile__img--48">
                <a>
                    <img th:src="@{/assets/images/temp/profile.png}" alt="">
                </a>
            </div>
            <div class="profile__info">
                <p class="name">
                    <span class="text-body3 text-ellipsis" th:text="${user.userName}"></span>
                </p>
                <p class="team">
                    <span class="text-caption1" th:text="${user.companyName}"></span>
                </p>
            </div>
        </div>
        <nav class="main-lnb">
            <ul>
                <li>
                    <a href="#" class="menu-item" id="alertMenuBtn">
                        <span class="menu-icon">
                            <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#notification}"/></svg>
                        </span>
                        <p class="menu-title" >
                            <span class="menu-title__text">ÏïåÎ¶º</span>
                            <span class="menu-title__num" id="alertBadge"></span>
                        </p>
                    </a>
                    <div class="layerpopup-wrap alarm-wrap" id="alertDropdownMenu" style="display:none">
                        <!-- ÏïåÎ¶º ÎÇ¥Ïö©Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê® -->
                    </div>
                </li>
                <li>
                    <a href="#" class="menu-item" id="settingMenuBtn">
                        <span class="menu-icon">
                            <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#setting}"/></svg>
                        </span>
                        <p class="menu-title">
                            <span class="menu-title__text">ÏÑ§Ï†ï</span>
                        </p>
                    </a>
                    <!-- ÏÑ§Ï†ï(ÌÜ±ÎãàÎ∞îÌÄ¥) ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥ Ï∂îÍ∞Ä -->
                    <ul class="dropdown-menu" id="settingDropdownMenu" style="display:none">
                        <li id="changePw">
                            <a href="#" onclick="if(confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) window.location.href='/logout'; else alert('Ï∑®ÏÜåÌïòÏòÄÏäµÎãàÎã§.'); return false;">Î°úÍ∑∏ÏïÑÏõÉ</a>
                        </li>
                        <li id="logout">
                            <a href="#" onclick="if(confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) window.location.href='/logout'; else alert('Ï∑®ÏÜåÌïòÏòÄÏäµÎãàÎã§.'); return false;">Î°úÍ∑∏ÏïÑÏõÉ</a>
                        </li>
                    </ul>
                </li>
            </ul>
            <ul>
                <li>
                    <a href="ticketList" class="menu-item">
                            <span class="menu-icon">
                                <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#inbox-archive}"/></svg>
                            </span>
                        <p class="menu-title">
                            <span class="menu-title__text">ÏöîÏ≤≠Í¥ÄÎ¶¨</span>
                            <span class="menu-title__num"></span>
                        </p>
                    </a>
                </li>
                <li th:if="${userClass != 'USER'}">
                    <a href="ticketListAdmin" class="menu-item">
                            <span class="menu-icon">
                                <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#inbox-archive}"/></svg>
                            </span>
                        <p class="menu-title">
                            <span class="menu-title__text">ÏöîÏ≤≠Í¥ÄÎ¶¨(Í¥ÄÎ¶¨Ïûê)</span>
                            <span class="menu-title__num"></span>
                        </p>
                    </a>
                </li>
                <li th:if="${userClass != 'USER'}">
                    <a href="systemBoardList" class="menu-item">
                            <span class="menu-icon">
                                <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#file-info}"/></svg>
                            </span>
                        <p class="menu-title">
                            <span class="menu-title__text">ÏãúÏä§ÌÖú Í¥ÄÎ¶¨</span>
                            <span class="menu-title__num"  th:field=${userClass} ></span>
                        </p>
                    </a>
                </li>
                <li>
                    <a href="noticeBoardList" class="menu-item">
                            <span class="menu-icon">
                                <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#pin}"/></svg>
                            </span>
                        <p class="menu-title">
                            <span class="menu-title__text">Í≥µÏßÄÏÇ¨Ìï≠</span>
                            <span class="menu-title__num"></span>
                        </p>
                    </a>
                </li>
                <!--ÌÜµÍ≥Ñ ÌòÑÌô© -->
                <li class="tree-item" th:if="${userClass != 'USER'}">
                    <a href="#" class="menu-item" id="analytics">
                        <span class="menu-icon">
                            <i class="ri-bar-chart-box-line"></i>
                        </span>
                        <p class="menu-title">
                            <span class="menu-title__text">ÌÜµÍ≥Ñ ÌòÑÌô©</span>
                            <span class="menu-icon">
                                <button class="tree-arrow-btn"></button>
                            </span>
                        </p>
                    </a>
                    <!-- ÌïòÏúÑ Î©îÎâ¥ (Ï¥àÍ∏∞ÏóêÎäî Ïà®ÍπÄ) -->
                    <ul class="tree-list--sub-2">
                        <li>
                            <a href="analytics_openAndClose" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">ÏöîÏ≤≠/Ï≤òÎ¶¨ ÌòÑÌô©</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                        <li>
                            <a href="analytics_week" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Ï£ºÍ∞ÑÏ≤òÎ¶¨ ÌòÑÌô©</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                        <li>
                            <a href="analytics_leftover" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Í≥†Í∞ùÏÇ¨Î≥Ñ ÏûîÏó¨ ÌòÑÌô©</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                    </ul>
                </li>
                <!--//ÌÜµÍ≥Ñ ÌòÑÌô©-->
                <!--Í¥ÄÎ¶¨Í∏∞Îä•-->
                <li th:if="${userClass != 'USER'}">
                    <a href="#" class="menu-item" id="adminmenu">
                        <span class="menu-icon">
                            <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#file-settings}"/></svg>
                        </span>
                        <p class="menu-title">
                            <span class="menu-title__text">Í¥ÄÎ¶¨Í∏∞Îä•</span>
                            <span class="menu-icon">
                                <button class="tree-arrow-btn"></button>
                            </span>
                        </p>
                    </a>
                    <!-- ÌïòÏúÑ Î©îÎâ¥ (Ï¥àÍ∏∞ÏóêÎäî Ïà®ÍπÄ) -->
                    <ul class="tree-list--sub-2" style="display: none;">
                        <li >
                            <a href="opReportList" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Ïö¥ÏòÅÏßÄÏõêÎ≥¥Í≥†ÏÑú</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                        <li>
                            <a href="mailHistory" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Î∞úÏÜ°ÎÇ¥Ïó≠</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                        <li>
                            <a href="clientManage" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Í≥†Í∞ùÍ¥ÄÎ¶¨</span>
                                    <span class="menu-title__num"></span>
                                </p>
                            </a>
                        </li>
                        <li>
                            <a href="/managePage" class="menu-item">
                                <p class="menu-title">
                                    <span class="menu-title__text">Í¥ÄÎ¶¨Í∏∞Îä•</span>
                                </p>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div class="quickmenu">
            <button type="button" class="btn btn--l primary-btn quick-btn"  th:onclick="openContact();">
       <!--         <svg class="icon"><i class="ri-customer-service-2-line"></i></svg>-->
                <span>Îã¥ÎãπÏûê ÎπÑÏÉÅ Ïó∞ÎùΩÎßù</span>
            </button>
            <!-- üõë ÎπÑÏÉÅÏó∞ÎùΩÎßù Î™®Îã¨ ÏãúÏûë -->
            <div id="emergencyContact" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
                <div style="background-color: white; width: 30%; margin: 10% auto; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);">

                    <!-- Î™®Îã¨ Ìó§Îçî -->
                    <div style="background-color: #79b3f1; color: white; padding: 15px; font-size: 18px; font-weight: bold; text-align: center; border-radius: 8px 8px 0 0;">
                        üìû ÎπÑÏÉÅÏó∞ÎùΩÎßù
                        <span onclick="openContact()" style="float: right; cursor: pointer;">‚úñ</span>
                    </div>

                    <!-- Î™®Îã¨ Î≥∏Î¨∏ -->
                    <div style="padding: 20px;">
                        <table style="width: 100%; border-collapse: collapse;" id ="contactTable">
                            <thead>
                            <tr style="background-color: #79b3f1;">
                                <th style="padding: 10px; border-bottom: 2px solid #ddd;font-size: 13px;">Ïù¥Î¶Ñ</th>
                                <th style="padding: 10px; border-bottom: 2px solid #ddd;font-size: 13px;">Ïù¥Î©îÏùº</th>
                                <th style="padding: 10px; border-bottom: 2px solid #ddd;font-size: 13px;">Ïó∞ÎùΩÏ≤ò</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>

                    <!-- Î™®Îã¨ Ìë∏ÌÑ∞ -->
                    <div style="padding: 15px; text-align: center; border-top: 1px solid #ddd;">
                        <button onclick="openContact()"
                                style="background-color: gray; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
                            Îã´Í∏∞
                        </button>
                    </div>

                </div>
            </div>
            <!-- üõë ÎπÑÏÉÅÏó∞ÎùΩÎßù Î™®Îã¨ ÎÅù -->
        </div>
        <div class="quickmenu">
            <button type="button" class="btn btn--l primary-btn quick-btn"  th:onclick="'window.location.href=\'' + @{/ticketCreate} + '\''">
                <svg class="icon"><use th:href="@{/assets/images/icon/sprite-sheet.svg#pencil}"/></svg>
                <span>Îπ†Î•∏ ÏûëÏÑ±</span>
            </button>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function () {
                let currentPage = 1; // ÌòÑÏû¨ ÌéòÏù¥ÏßÄ

                // ÏïåÎ¶º Î¶¨Ïä§Ìä∏ Ï¥àÍ∏∞ Î°úÎìú
                loadAlerts();
                // ÎπÑÏÉÅ Ïó∞ÎùΩÎßù Î°úÎìú
                loadContact();

                // Î¨¥Ìïú Ïä§ÌÅ¨Î°§ Ïù¥Î≤§Ìä∏
                $('#alertDropdownMenu').on('scroll', function () {
                    const $this = $(this);
                    // Ïä§ÌÅ¨Î°§Ïù¥ ÌïòÎã®Ïóê ÎèÑÎã¨ÌñàÏùÑ Îïå Îã§Ïùå ÌéòÏù¥ÏßÄ Î°úÎìú
                    if ($this.scrollTop() + $this.innerHeight() >= this.scrollHeight) {
                        currentPage++; // Îã§Ïùå ÌéòÏù¥ÏßÄ
                        loadAlerts(); // Îã§Ïùå ÏïåÎ¶º Î°úÎìú
                    }
                });

                // -------------------
                // alert Ìò∏Ï∂ú Î∞è Í∞±Ïã†
                // -------------------
                function loadAlerts() {
                    $.ajax({
                        url: '/alert',
                        method: 'GET',
                        success: function (data) {
                            const alertCount = data.alertCount; // ÏïåÎ¶º Í∞úÏàò
                            const alerts = data.alerts; // ÏïåÎ¶º Î™©Î°ù

                            const $alertBadge = $('#alertBadge');
                            const $alertDropdownMenu = $('#alertDropdownMenu'); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥

                            // ÏïåÎ¶º Î∞∞ÏßÄ ÌëúÏãú
                            if (alertCount > 0) {
                                $alertBadge.html('<p>' + alertCount + '</p>');
                            } else {
                                $alertBadge.html('').removeClass('active');
                            }

                            // ÎìúÎ°≠Îã§Ïö¥ ÎÇ¥Ïö© Ï∂îÍ∞Ä
                            if (alerts && alerts.length > 0) {
                                let alertListHtml = `<div class="layerpopup__header">
                                                            <h1 class="layerpopup__title">ÏïåÎ¶º</h2>
                                                            <div class="flex gap--8">
                                                                <button type="button" id="markAllAsRead"  class="btn btn--s ghost-btn">Î™®Îëê ÏùΩÏùå</button>
                                                                <button id="closeAlertBtn"  class="btn icon-btn close-btn"><svg class="icon"><use href='./assets/images/icon/sprite-sheet.svg#close'/></svg></button>
                                                            </div>
                                                        </div>
                                                         <div class='alarm-content'><ul class='alarm-list'>
                                                    `;
                                alerts.forEach(alert => {
                                    alertListHtml += `
                                        <li class="${alert.readYn === 'Y' ? 'read-alert' : ''} alarm--item">
                                            <button type='button' name='close-btn' class='btn icon-btn close-btn'>
                                                <svg class='icon'><use href='./assets/images/icon/sprite-sheet.svg#close'/></svg>
                                            </button>
                                            <a>
                                                <span class="${alert.readYn === 'Y' ? '' : 'badge badge--s'}"></span>
                                                <div class='profile' name='alarmview' data-id="${alert.alertId}" data-alertObjectId="${alert.alertObjectId}">
                                                    <div class='profile__info'>
                                                        <p class='alarm__user-info'>
                                                            <span class='name'>${alert.userName}</span>
                                                            <span class='date'>${alert.alertDt}</span>
                                                        </p>
                                                        <div class='alarm__text-wrap'>
                                                            <span class="${alert.alertType === 'OPEN' ? 'tag tag--blue'
                                                                            : alert.alertType === 'RECEIPT' ? 'tag tag--navy'
                                                                            : alert.alertType === 'PROGRESS' ? 'tag tag--green'
                                                                            : alert.alertType === 'REVIEW' ? 'tag tag--orange'
                                                                            : alert.alertType === 'CLOSED' ? 'tag tag--gray' : 'tag tag--purple'}">
                                                                  ${alert.alertType === 'OPEN' ? 'Îì±Î°ù'
                                                                            : alert.alertType === 'RECEIPT' ? 'Ï†ëÏàò'
                                                                            : alert.alertType === 'PROGRESS' ? 'ÏßÑÌñâ'
                                                                            : alert.alertType === 'REVIEW' ? 'Í≤ÄÌÜ†'
                                                                            : alert.alertType === 'CLOSED' ? 'ÏôÑÎ£å' : 'ÎåìÍ∏Ä'}
                                                            </span>

                                                            <p class='alarm__text'>
                                                                ${alert.content}
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </a>
                                      </li>
                                    `;
                                });
                                alertListHtml +='</ul></div>';
                                // ÏïåÎ¶º Î¶¨Ïä§Ìä∏Î•º ÎìúÎ°≠Îã§Ïö¥Ïóê Ï∂îÍ∞Ä
                                $alertDropdownMenu.html(alertListHtml);
                            } else {
                                // ÏïåÎ¶ºÏù¥ ÏóÜÏúºÎ©¥ "ÏïåÎ¶º ÏóÜÏùå" ÌëúÏãú
                                $alertDropdownMenu.html('<li style="text-align: center;">ÏïåÎ¶ºÏù¥ ÏóÜÏäµÎãàÎã§.</li>');
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('ÏïåÎ¶º Î™©Î°ù Ï°∞Ìöå Ïã§Ìå®:', error);
                        }
                    });
                }

                // -------------------
                // ÏïåÎ¶º Î©îÎâ¥ ÌÜ†Í∏Ä
                // -------------------
                const $alertMenuBtn = $('#alertMenuBtn');
                const $alertDropdownMenu = $('#alertDropdownMenu'); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥

                // ÏïåÎ¶º Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
                $alertMenuBtn.on('click', function(event) {
                    event.stopPropagation(); // Ïù¥Î≤§Ìä∏ Ï†ÑÌåå Î∞©ÏßÄ
                    $alertDropdownMenu.toggle(); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
                    $('#settingDropdownMenu').hide(); // ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥Ïù¥ Ïó¥Î†§ÏûàÎã§Î©¥ Îã´Í∏∞
                });

                // -------------------
                // ÏïåÎûå Îã´Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠
                // -------------------
                $(document).on("click", "#closeAlertBtn", function() {
                    $alertDropdownMenu.toggle(); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
                });

                // -------------------
                // ÏÑ§Ï†ï Î©îÎâ¥ ÌÜ†Í∏Ä
                // -------------------
                const $settingMenuBtn = $("#settingMenuBtn");
                const $settingDropdownMenu = $("#settingDropdownMenu"); // ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥

                // ÏÑ§Ï†ï Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
                $settingMenuBtn.on("click", function(event) {
                    event.stopPropagation(); // Ïù¥Î≤§Ìä∏ Ï†ÑÌåå Î∞©ÏßÄ
                    $settingDropdownMenu.toggle(); // ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
                    $('#alertDropdownMenu').hide(); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥Ïù¥ Ïó¥Î†§ÏûàÎã§Î©¥ Îã´Í∏∞
                });

                // -------------------
                // ÎìúÎ°≠Îã§Ïö¥ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Ïà®Í∏∞Í∏∞
                // -------------------
                $(document).on("click", function(event) {
                    // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥Ïù¥ Ïó¥Î†§ÏûàÍ≥† ÌÅ¥Î¶≠Ìïú Í≥≥Ïù¥ ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥Í∞Ä ÏïÑÎãàÎ©¥ Ïà®Í∏∞Í∏∞
                    if (!$(event.target).closest('#alertMenuBtn, #alertDropdownMenu').length) {
                        $alertDropdownMenu.hide();
                    }

                    // ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥Ïù¥ Ïó¥Î†§ÏûàÍ≥† ÌÅ¥Î¶≠Ìïú Í≥≥Ïù¥ ÏÑ§Ï†ï ÎìúÎ°≠Îã§Ïö¥ Î©îÎâ¥Í∞Ä ÏïÑÎãàÎ©¥ Ïà®Í∏∞Í∏∞
                    if (!$(event.target).closest('#settingMenuBtn, #settingDropdownMenu').length) {
                        $settingDropdownMenu.hide();
                    }
                });


            });

            // -------------------
            // ÏïåÎ¶º ÎÇ¥Ïó≠ ÏÇ≠Ï†ú
            // ------------------
            $(document).on('click', '[name="close-btn"]', function () {
                const $alertItem = $(this).closest('li'); // ÌòÑÏû¨ ÏïåÎ¶º Ìï≠Î™©
                const alertId = $alertItem.find('.profile').data('id'); // ÏïåÎ¶º ID

                const data = new URLSearchParams({
                    alertId: alertId,
                });

                fetch('/alert', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: data.toString()
                })
                .then(response => response.text())
                .then(data => {
                    alert("ÏÇ≠Ï†úÌñàÏäµÎãàÎã§.");

                    // ÏÇ≠Ï†ú ÏÑ±Í≥µ Ïãú UIÏóêÏÑú Ï†úÍ±∞
                    $alertItem.remove();
                })
                .catch(error => console.error('ÏÇ≠Ï†úÏ≤òÎ¶¨ Ï§ë Ïò§Î•ò Î∞úÏÉù:', error));

            });

            // -------------------
            // Ï¢Ö ÏïåÎ¶º ÌÅ¥Î¶≠ Ïãú -1
            // ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            // ------------------
            $(document).on('click', '[name="alarmview"]', function (e) {
                e.preventDefault(); // Í∏∞Î≥∏ ÎèôÏûë(ÌéòÏù¥ÏßÄ Ïù¥Îèô)ÏùÑ Î∞©ÏßÄ
                const alertId = $(this).data('id'); // ÏïåÎ¶º ID Í∞ÄÏ†∏Ïò§Í∏∞
                const alertObjectId =  $(this).data('alertobjectid')  // data-alertObjectId ÏÜçÏÑ±Í∞íÏùÑ Í∞ÄÏ†∏Ïò¥

                // x-www-form-urlencoded ÌòïÏãùÏúºÎ°ú Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                const data = new URLSearchParams({
                    alertId: alertId,
                    alertObjectId: alertObjectId,
                });

                // Ajax ÏöîÏ≤≠
                fetch('/alert', {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: data.toString()
                })
                .then(response => response.text())
                .then(data => {
                    // ÌéòÏù¥ÏßÄ Ïù¥Îèô
                    window.location.href = '/ticketView?id='+alertObjectId;
                })
                .catch(error => console.error('ÏùΩÏùåÏ≤òÎ¶¨ Ï§ë Ïò§Î•ò Î∞úÏÉù:', error));
            });

            // ------------------
            // "Î™®Îëê ÏùΩÏùå" Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÏÉâÏÉÅ Î≥ÄÍ≤Ω
            // ------------------
            $(document).on('click', '#markAllAsRead', function () {
                fetch('/alert/all', {
                    method: 'PUT',
                })
                .then(response => {
                    if (response.ok) {
                        // ÏÑ±Í≥µ Ïãú Î™®Îì† ÏïåÎ¶ºÏùò ÏÉÅÌÉúÎ•º 'read-alert'Î°ú Î≥ÄÍ≤Ω
                        $('#alertDropdownMenu li').each(function () {
                            $(this).addClass('read-alert'); // ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
                        });
                        console.log('Ï†ÑÏ≤¥ ÏïåÎ¶º ÏùΩÏùå Ï≤òÎ¶¨ ÏôÑÎ£å');
                    } else {
                        console.error('Ï†ÑÏ≤¥ ÏïåÎ¶º ÏùΩÏùå Ï≤òÎ¶¨ Ïã§Ìå®');
                    }
                })
                .catch(error => console.error('Î™®Îëê ÏùΩÏùå Ï≤òÎ¶¨ Ï§ë Ïò§Î•ò Î∞úÏÉù:', error));
            });

            // -------------------
            // ÎπÑÎ∞ÄÎ≤àÌò∏ Ï¥àÍ∏∞Ìôî Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú
            // ÏöîÏ≤≠ Ï†ÑÏÜ° ÌõÑ alert
            // ÏûëÏÑ±Ïûê : Ï†úÏòàÏÜî
            // ------------------
            if (document.getElementById('resetPasswordBtn')!=null){
            document.getElementById('resetPasswordBtn').addEventListener('click', function (event) {
                event.preventDefault(); // Í∏∞Î≥∏ ÎßÅÌÅ¨ ÎèôÏûë Î∞©ÏßÄ

                const spinner = document.getElementById('loadingSpinner');
                spinner.style.display = 'flex'; // Ïä§ÌîºÎÑà ÌëúÏãú

                fetch('/resetPassword', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                })
                .then(response => {
                    if (response.ok) {
                        alert("ÏûÑÏãú ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïù¥Î©îÏùºÎ°ú Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§");
                        window.location.href = '/login';
                    } else {
                        alert("ÎπÑÎ∞ÄÎ≤àÌò∏ Ï¥àÍ∏∞Ìôî ÏöîÏ≤≠ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("ÏöîÏ≤≠ Ï≤òÎ¶¨ Ï§ë Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
                })
                .finally(() => {
                    spinner.style.display = 'none'; // Ïä§ÌîºÎÑà Ïà®Í∏∞Í∏∞
                });
            });

            }

            function openContact(){
                $('#emergencyContact').toggle(); // ÏïåÎ¶º ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
            }

            function loadContact(){
                $.ajax({
                    url: '/contacts', // ÏÑúÎ≤Ñ Ïª®Ìä∏Î°§Îü¨ URL
                    type: 'GET',
                    success: function(response) {
                        if (response.status === 'success') {
                            var contacts = response.data; // ÏùëÎãµ Îç∞Ïù¥ÌÑ∞ÏóêÏÑú contactsÎ•º Í∞ÄÏ†∏Ïò¥

                            // ÌÖåÏù¥Î∏î tbody ÎπÑÏö∞Í∏∞
                            $('#contactTable tbody').empty();

                            // contacts Îç∞Ïù¥ÌÑ∞Î•º Î∞òÎ≥µÌï¥ÏÑú ÌÖåÏù¥Î∏îÏóê Ï∂îÍ∞Ä
                            contacts.forEach(function(contact) {
                                var row = '<tr style="text-align: center;">' +
                                          '<td style="padding: 10px; border-bottom: 1px solid #ddd;font-size: 13px;">' + contact.userName + '</td>' +
                                          '<td style="padding: 10px; border-bottom: 1px solid #ddd;font-size: 13px;">' + contact.email + '</td>' +
                                          '<td style="padding: 10px; border-bottom: 1px solid #ddd;font-size: 13px;">' + contact.phone + '</td>' +
                                          '</tr>';

                                // tbodyÏóê Ìñâ Ï∂îÍ∞Ä
                                $('#contactTable tbody').append(row);
                            });
                        } else {
                            console.error('Ïó∞ÎùΩÏ≤ò Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                        }
                    },
                    error: function(error) {
                       // showMessage('error', 'Ïò§Î•ò', 'ÎåìÍ∏Ä Îì±Î°ù Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                    }
                });

            }
        </script>
    </div>
</body>